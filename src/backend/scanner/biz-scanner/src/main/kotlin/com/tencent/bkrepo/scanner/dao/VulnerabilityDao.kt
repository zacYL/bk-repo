package com.tencent.bkrepo.scanner.dao

import com.tencent.bkrepo.common.mongo.dao.simple.SimpleMongoDao
import com.tencent.bkrepo.scanner.model.TVulnerability
import org.springframework.data.mongodb.core.query.Criteria
import org.springframework.data.mongodb.core.query.Query
import org.springframework.stereotype.Repository

@Repository
class VulnerabilityDao : SimpleMongoDao<TVulnerability>() {
    fun findByName(name: String): TVulnerability? {
        val query = Query(Criteria.where(TVulnerability::name.name).`is`(name))
        return this.findOne(query)
    }

    fun findByNameAndSource(name: String, source: String): TVulnerability? {
        val query = Query(Criteria.where(TVulnerability::name.name).`is`(name)
            .and(TVulnerability::source.name).`is`(source))
        return this.findOne(query)
    }
}
