# 仓库权限（auth）

## 加载仓库下用户/部门

* API: GET /api/bksoftware/unit/{repoName}

* 请求体

  此接口请求体为空

* 请求字段说明

  | 字段     | 类型   | 默认值 | 是否必传 | 说明   | Description |
    | -------- | ------ | ------ | -------- | ------ | ----------- |
  | repoName | String | 无     | 是       | 仓库名 | repo name   |

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": {
          "user": [
              {
                  "unitId": "weaving",
                  "unitType": "USER",
                  "allowPush": false
              },
              {
                  "unitId": "admin",
                  "unitType": "USER",
                  "allowPush": true
              }
          ],
          "department": [
            {
                  "unitId": "guangdong",
                  "unitType": "DEPARTMENT",
                  "allowPush": false
              }
          ]
      },
      "traceId": ""
  }
  ```

* data字段说明

  | 字段       | 类型    | 说明                             | Description |
    | ---------- | ------- | -------------------------------- | ----------- |
  | user       | object  | 用户                             | user        |
  | department | object  | 部门                             | department  |
  | unitId     | String  | 用户/部门 id                     | Unit id     |
  | unitType   | String  | 类型 USER:用户， DEPARTMENT:部门 | Unit type   |
  | allowPush  | Boolean | 是否有推送权限                   | allow push  |

## 修改用户/部门权限

* API: PUT /api/bksoftware/unit/permission/update/{repoName}?type={UnitType}&push={Boolean}

* 请求体

  ```json
  ["userId01","userId02"]
  ```


* 请求字段说明

  | 字段     | 类型    | 默认值 | 是否必传 | 说明                             | Description |
    | -------- | ------- | ------ | -------- | -------------------------------- | ----------- |
  | repoName | String  | 无     | 是       | 仓库名                           | repo name   |
  | unitType | String  | 无     | 是       | 类型 USER:用户， DEPARTMENT:部门 | unit type   |
  | push     | Boolean | False  | 是       | 是否给添加用户推送权限           | allow push  |

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": true,
      "traceId": ""
  }
  ```

## 添加用户/部门

* API: POST /api/bksoftware/unit/{repoName}?type={UnitType}&push={Boolean}

* 请求体

  ```json
  ["userId01","userId02"]
  ```


* 请求字段说明

  | 字段     | 类型    | 默认值 | 是否必传 | 说明                             | Description |
    | -------- | ------- | ------ | -------- | -------------------------------- | ----------- |
  | repoName | String  | 无     | 是       | 仓库名                           | repo name   |
  | unitType | String  | 无     | 是       | 类型 USER:用户， DEPARTMENT:部门 | unit type   |
  | push     | Boolean | False  | 是       | 是否给添加用户推送权限           | allow push  |

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": true,
      "traceId": ""
  }
  ```

## 删除用户/部门

* API: DELETE /api/bksoftware/unit/{repoName}

* 请求体

  ```json
  {
      "user":["abc","bcd"],
      "department":["abc","bcd"]
  }
  ```


* 请求字段说明

  | 字段       | 类型         | 默认值 | 是否必传 | 说明              | Description     |
    | ---------- | ------------ | ------ | -------- | ----------------- | --------------- |
  | repoName   | String       | 无     | 是       | 仓库名            | repo name       |
  | user       | List<String> | 无     | 是       | userId 集合       | list of user id |
  | department | List<String> | 无     | 是       | departmentId 集合 | list of user id |

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": true,
      "traceId": ""
  }
  ```

