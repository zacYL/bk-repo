package com.tencent.bkrepo.scanner.service.impl

import com.tencent.bkrepo.scanner.dao.VulnerabilityDao
import com.tencent.bkrepo.scanner.model.TVulnerability
import com.tencent.bkrepo.scanner.service.VulnerabilityService
import org.springframework.stereotype.Service

@Service
class VulnerabilityServiceImpl(
    private val vulnerabilityDao: VulnerabilityDao
) : VulnerabilityService {
    override fun insert(tVulnerability: TVulnerability) {
        getByNameAndSource(tVulnerability.name, tVulnerability.source)?.let {
            return
        }
        vulnerabilityDao.insert(tVulnerability)
    }

    override fun getByName(name: String): TVulnerability? {
        return vulnerabilityDao.findByName(name)
    }

    override fun getByNameAndSource(name: String, source: String): TVulnerability? {
        return vulnerabilityDao.findByNameAndSource(name, source)
    }
}
