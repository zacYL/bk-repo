package com.tencent.bkrepo.scanner.model

import com.tencent.bkrepo.common.checker.pojo.VulnerabilitySeverity
import org.springframework.data.mongodb.core.index.CompoundIndex
import org.springframework.data.mongodb.core.index.CompoundIndexes
import org.springframework.data.mongodb.core.mapping.Document

@Document("vulnerability")
@CompoundIndexes(
    CompoundIndex(name = "unique_index", def = "{'source': 1, 'name': 1}", unique = true, background = true)
)
data class TVulnerability(
    val source: String,
    val name: String,
    val cvssv2: String?,
    val cvssv3: String?,
    val cwes: List<String>,
    val description: String,
    val notes: String,
    val references: List<String>,
    val severity: VulnerabilitySeverity,
    val vulnerableSoftware: List<String>
)
