# 审计日志

[toc]

## 获取可选审计日志事件类型

* API: GET /api/log/event/type

* API 名称：log_eventType

* 功能说明：

  - 中文：获取可选审计日志事件类型
  - English：get log eventType

* 请求体

  此接口请求体为空

* 请求字段说明

  无

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": {
          "REPO_CREATED": "创建仓库",
          "REPO_UPDATED": "更新仓库",
          "REPO_DELETED": "删除仓库",
          "VERSION_CREATED": "创建制品",
          "VERSION_DELETED": "删除制品",
          "VERSION_DOWNLOAD": "下载制品",
          "VERSION_UPDATED": "更新制品",
          "VERSION_STAGED": "晋级制品",
          "ADMIN_ADD": "添加管理员",
          "ADMIN_DELETE": "移除管理员",
          "PROJECT_CREATED": "创建项目",
          "METADATA_SAVED": "添加元数据",
          "METADATA_DELETED": "删除元数据"
      },
      "traceId": ""
  }
  ```

  



## 审计日志分页

* API: GET
  /api/log/page?type={ResourceType}eventType={REPO_CREATED,REPO_UPDATED}&projectId={projectId}&repoName={repoName}&operator={uid}&startTime={String}&endTime={String}&pageNumber={pageNumber}&pageSize={pageSize}

* 请求体

  此接口请求体为空

* 请求字段说明

| 字段       | 类型         | 默认值 | 是否必传 | 说明                               | Description  |
| ---------- | ------------ | ------ | -------- | ---------------------------------- | ------------ |
| type       | String       | 无     | 否       | 资源类型                           | ResourceType |
| eventType  | List<String> | 无     | 否       | 事件类型(从上面事件类型中选择)数组 | EventTypes   |
| projectId  | String       | 无     | 否       | 项目名                             | projectId    |
| repoName   | String       | 无     | 否       | 仓库名                             | repoName     |
| operator   | String       | 无     | 否       | 操作人                             | userId       |
| startTime  | String       | 无     | 否       | 开始时间                           | start time   |
| endTime    | String       | 无     | 否       | 结束时间                           | end time     |
| pageNumber | Int          | 1      | 否       | 页数                               | page number  |
| pageSize   | Int          | 20     | 否       | 分页数量                           | page size    |

* 响应体

  ```json
  {
      "code": 0,
      "message": null,
      "data": {
          "pageNumber": 1,
          "pageSize": 20,
          "totalRecords": 1,
          "totalPages": 1,
          "records": [
              {
                  "createdDate": "2021-06-29T19:23:42.272",
                  "operate": "上传包",
                  "userId": "weaving",
                  "clientAddress": "192.168.160.100",
                  "result": true,
                  "content": {
                      "projectId": "bksoftware",
                      "repoType": "MAVEN",
                      "resKey": "maven::bksdk::1.0.0",
                      "des": null
                  }
              }
          ],
          "page": 1,
          "count": 1
      },
      "traceId": ""
  }
  ```
